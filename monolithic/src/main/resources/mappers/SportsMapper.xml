<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ohgiraffers.geogieoddae.sports.query.mapper.SportsMapper">

    <!-- 스포츠 DTO 매핑 -->
    <resultMap id="sportResultMap" type="com.ohgiraffers.geogieoddae.sports.query.dto.SportsQueryDto">
        <result property="sportCode" column="sport_code"/>
        <result property="sportName" column="sport_name"/>
    </resultMap>

    <!-- 팀 DTO 매핑 -->
    <resultMap id="teamResultMap" type="com.ohgiraffers.geogieoddae.sports.query.dto.TeamQueryDto">
        <result property="teamCode" column="team_code"/>
        <result property="teamName" column="team_name"/>
        <result property="leagueName" column="league_name"/>
        <result property="sportName" column="sport_name"/>
    </resultMap>

    <!-- 스포츠 목록 조회 -->
    <select id="selectSportList" resultMap="sportResultMap">
        SELECT sport_code, sport_name
        FROM sport
        ORDER BY sport_code ASC
    </select>

    <!-- 스포츠 상세 조회 -->
    <select id="selectSportByCode" resultMap="sportResultMap">
        SELECT sport_code, sport_name
        FROM sport
        WHERE sport_code = #{sportCode}
    </select>

    <!-- 전체 팀 목록 조회 -->
    <select id="selectTeamList" resultMap="teamResultMap">
        SELECT
            t.team_code,
            t.team_name,
            l.name AS league_name,
            s.sport_name
        FROM team t
                 JOIN league l ON t.league_code = l.league_code
                 JOIN sport s ON l.sport_code = s.sport_code
        ORDER BY t.team_code ASC
    </select>

    <!-- 특정 종목 팀 목록 조회 -->
    <select id="selectTeamListBySportCode" resultMap="teamResultMap">
        SELECT
            t.team_code,
            t.team_name,
            l.name AS league_name,
            s.sport_name
        FROM team t
                 JOIN league l ON t.league_code = l.league_code
                 JOIN sport s ON l.sport_code = s.sport_code
        WHERE s.sport_code = #{sportCode}
        ORDER BY t.team_code ASC
    </select>

    <!-- 팀 상세 조회 -->
    <select id="selectTeamByCode" resultMap="teamResultMap">
        SELECT
            t.team_code,
            t.team_name,
            l.name AS league_name,
            s.sport_name
        FROM team t
                 JOIN league l ON t.league_code = l.league_code
                 JOIN sport s ON l.sport_code = s.sport_code
        WHERE t.team_code = #{teamCode}
    </select>

</mapper>
